{"version":3,"sources":["resources/component/atoms/Title/index.js","resources/component/molecules/IconCard/index.js","pages/default/ResizeIcon/index.js"],"names":["Title","props","children","size","borderBottom","className","TitleRoot","styled","div","css","IconCard","src","id","webId","version","IconCardRoot","reName","imgSize","beforeUpload","file","isJpgOrPng","type","message","error","ResizeIcon","useState","imageUrl","setImageUrl","setWebId","alert","setAlert","alertText","setAlertText","resizeImg","setResizeImg","valueVersion","setValueVersion","setH1Title","useContext","MyContext","uploadButton","PlusOutlined","style","marginTop","resizeImageUrl","canvas","document","createElement","ctx","getContext","Image","width","height","drawImage","toDataURL","useEffect","ResizeIconRoot","AlertRoot","banner","closable","onClose","ResizeIconHeader","gutter","span","UploadRoot","listType","showUploadList","onChange","info","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","getBase64","originFileObj","alt","InputRoot","value","e","target","Group","display","flexDirection","block","onClick","orig_src","querySelector","setTimeout","zip","JSZip","name","i","length","getElementById","getAttribute","replace","textContent","base64","generateAsync","then","content","saveAs","ResizeIconBody","map","row","index","main","section","Upload","Alert"],"mappings":"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","file":"ResizeIcon.3121d8443c3069a00a20.js","sourcesContent":["import styled, { css } from 'styled-components';\r\n\r\nfunction Title(props) {\r\n    const { children, size, borderBottom, className } = props;\r\n\r\n    return (\r\n        <TitleRoot className={className} size={size} borderBottom={borderBottom}>\r\n            {children}\r\n        </TitleRoot>\r\n    );\r\n}\r\n\r\nexport default Title;\r\n\r\nconst TitleRoot = styled.div`\r\n    font-size: ${(props) => props.size}px;\r\n    ${(props) =>\r\n        props.borderBottom &&\r\n        css`\r\n            padding-bottom: 10px;\r\n            border-bottom: 1px solid #fff;\r\n        `}\r\n`;\r\n","import React, { useState, useEffect } from 'react';\r\nimport styled from 'styled-components';\r\n\r\nfunction IconCard(props) {\r\n    const { size, src, id, webId, version } = props;\r\n\r\n    function reName() {\r\n        if (size !== 128) {\r\n            if (version === 1) {\r\n                return `app_icon_${size}x${size}.png`;\r\n            } else if (version === 2) {\r\n                return `app_icon_effects_${size}x${size}.png`;\r\n            }\r\n        } else {\r\n            if (version === 1) {\r\n                return `app_icon_${webId}.png`;\r\n            } else if (version === 2) {\r\n                return `app_icon_effects_${webId}.png`;\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <IconCardRoot>\r\n            <h3>\r\n                {size} x {size}\r\n            </h3>\r\n            <div className=\"img_img\">\r\n                <img src={src} id={'resizeImg' + (id + 1)} />\r\n            </div>\r\n            <p id={'iconName' + (id + 1)}>{reName()}</p>\r\n        </IconCardRoot>\r\n    );\r\n}\r\n\r\nexport default IconCard;\r\n\r\nconst IconCardRoot = styled.div`\r\n    text-align: center;\r\n    background-color: #fff;\r\n    border-radius: 4px;\r\n    padding: 10px;\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .img_img {\r\n        height: 192px;\r\n        position: relative;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 20px;\r\n    }\r\n\r\n    img {\r\n        position: absolute;\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        max-width: 100%;\r\n        max-height: 100%;\r\n    }\r\n\r\n    p {\r\n        margin-top: 10px;\r\n        margin-bottom: 0;\r\n        font-size: 16px;\r\n    }\r\n`;\r\n","import React, { useState, useEffect, useContext } from 'react';\r\n\r\nimport { MyContext } from '@reducers';\r\n\r\nimport { Form, Row, Col, Upload, message, Input, Button, Alert, Radio } from 'antd';\r\nimport { PlusOutlined } from '@ant-design/icons';\r\n\r\nimport styled from 'styled-components';\r\n\r\nimport JSZip from 'jszip';\r\nimport { saveAs } from 'file-saver';\r\n\r\nimport Title from '@component/atoms/Title';\r\nimport IconCard from '@component/molecules/IconCard';\r\n\r\nconst imgSize = [192, 180, 144, 128, 120, 96];\r\n\r\nfunction getBase64(img, callback) {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => callback(reader.result));\r\n    reader.readAsDataURL(img);\r\n}\r\n\r\nfunction beforeUpload(file) {\r\n    const isJpgOrPng = file.type === 'image/png';\r\n    if (!isJpgOrPng) {\r\n        message.error('請上傳PNG檔!');\r\n    }\r\n    return isJpgOrPng;\r\n}\r\n\r\nfunction ResizeIcon() {\r\n    const [imageUrl, setImageUrl] = useState('');\r\n    const [webId, setWebId] = useState('');\r\n    const [alert, setAlert] = useState(false);\r\n    const [alertText, setAlertText] = useState('');\r\n    const [resizeImg, setResizeImg] = useState(false);\r\n    const [valueVersion, setValueVersion] = useState(1);\r\n\r\n    const { setH1Title } = useContext(MyContext);\r\n\r\n    const uploadButton = (\r\n        <div>\r\n            <PlusOutlined />\r\n            <div style={{ marginTop: 8 }}>上傳圖片</div>\r\n        </div>\r\n    );\r\n\r\n    function handleChange(info) {\r\n        if (info.file.type === 'image/png') {\r\n            getBase64(info.file.originFileObj, (imageUrl) => {\r\n                setImageUrl(imageUrl);\r\n            });\r\n        }\r\n    }\r\n\r\n    function handleChangeID(e) {\r\n        setWebId(e.target.value);\r\n    }\r\n\r\n    function handleRenderImage() {\r\n        const orig_src = document.querySelector('.ant-upload-select-picture-card img');\r\n        if (!webId) {\r\n            setAlertText('請輸入站點ID');\r\n            setAlert(true);\r\n        } else if (!imageUrl) {\r\n            setAlertText('請上傳圖片');\r\n            setAlert(true);\r\n        } else if (orig_src.width < imgSize[0] || orig_src.height < imgSize[0]) {\r\n            setAlertText(`圖片尺寸錯誤，請上傳${imgSize[0]}x${imgSize[0]}以上的圖片`);\r\n            setAlert(true);\r\n            setImageUrl('');\r\n        } else {\r\n            setResizeImg(true);\r\n        }\r\n\r\n        setTimeout(() => {\r\n            setAlert(false);\r\n            setAlertText('');\r\n        }, 2000);\r\n    }\r\n\r\n    function handleAlertClose() {\r\n        setAlert(false);\r\n    }\r\n\r\n    function handleReset() {\r\n        setImageUrl('');\r\n        setWebId('');\r\n        setResizeImg(false);\r\n    }\r\n\r\n    function handleChangeVersion(e) {\r\n        setValueVersion(e.target.value);\r\n    }\r\n\r\n    function handleSave() {\r\n        const zip = new JSZip();\r\n        let src = '';\r\n        let name = '';\r\n        for (let i = 0; i < imgSize.length; i++) {\r\n            src = document\r\n                .getElementById(`resizeImg${i + 1}`)\r\n                .getAttribute('src')\r\n                .replace('data:image/png;base64,', '');\r\n            name = document.getElementById(`iconName${i + 1}`).textContent;\r\n            zip.file(name, src, { base64: true });\r\n        }\r\n        zip.generateAsync({ type: 'blob' }).then(function (content) {\r\n            if (valueVersion === 1) {\r\n                saveAs(content, `${webId}站點 標準版APP ICON`);\r\n            } else if (valueVersion === 2) {\r\n                saveAs(content, `${webId}站點 娛樂版APP ICON`);\r\n            }\r\n        });\r\n    }\r\n\r\n    function resizeImageUrl(size) {\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d');\r\n        const resizeImg = new Image();\r\n\r\n        resizeImg.src = imageUrl;\r\n        canvas.width = size;\r\n        canvas.height = size;\r\n\r\n        ctx.drawImage(resizeImg, 0, 0, size, size);\r\n        const dataURL = canvas.toDataURL('image/png');\r\n\r\n        return dataURL;\r\n    }\r\n\r\n    useEffect(() => {\r\n        setH1Title('APP ICON 圖片尺寸調整工具');\r\n    });\r\n\r\n    return (\r\n        <ResizeIconRoot>\r\n            {alert && <AlertRoot type=\"error\" message={alertText} banner closable onClose={handleAlertClose} />}\r\n            <ResizeIconHeader>\r\n                <Form>\r\n                    <Row gutter={32}>\r\n                        <Col span={10}>\r\n                            <TitleRoot size={20} borderBottom>\r\n                                上傳圖片\r\n                            </TitleRoot>\r\n                            <UploadRoot\r\n                                listType=\"picture-card\"\r\n                                showUploadList={false}\r\n                                beforeUpload={beforeUpload}\r\n                                onChange={handleChange}\r\n                            >\r\n                                {imageUrl ? (\r\n                                    <img src={imageUrl} alt=\"avatar\" style={{ width: '100%' }} />\r\n                                ) : (\r\n                                    uploadButton\r\n                                )}\r\n                            </UploadRoot>\r\n                        </Col>\r\n                        <Col span={10}>\r\n                            <TitleRoot size={20} borderBottom>\r\n                                圖片資訊\r\n                            </TitleRoot>\r\n                            <InputRoot>\r\n                                <p>站點ID</p>\r\n                                <Input size=\"small\" type=\"number\" value={webId} onChange={handleChangeID} />\r\n                            </InputRoot>\r\n                            <InputRoot>\r\n                                <p>版本</p>\r\n                                <Radio.Group value={valueVersion} onChange={handleChangeVersion}>\r\n                                    <Radio value={1}>標準版</Radio>\r\n                                    <Radio value={2}>娛樂版</Radio>\r\n                                </Radio.Group>\r\n                            </InputRoot>\r\n                        </Col>\r\n                        <Col span={4} style={{ display: 'flex', flexDirection: 'column' }}>\r\n                            <TitleRoot size={20} borderBottom>\r\n                                功能\r\n                            </TitleRoot>\r\n                            <Button type=\"primary\" size=\"large\" block onClick={handleRenderImage}>\r\n                                執行圖片縮放\r\n                            </Button>\r\n                            <Button\r\n                                type=\"danger\"\r\n                                size=\"large\"\r\n                                block\r\n                                style={{ marginTop: '10px' }}\r\n                                onClick={handleReset}\r\n                            >\r\n                                重置\r\n                            </Button>\r\n                            <Button\r\n                                type=\"primary\"\r\n                                size=\"large\"\r\n                                block\r\n                                style={{ marginTop: 'auto' }}\r\n                                onClick={handleSave}\r\n                            >\r\n                                打包下載\r\n                            </Button>\r\n                        </Col>\r\n                    </Row>\r\n                </Form>\r\n            </ResizeIconHeader>\r\n            <ResizeIconBody>\r\n                <Row gutter={[16, 16]}>\r\n                    {resizeImg &&\r\n                        imgSize.map((row, index) => (\r\n                            <Col span={6} key={row}>\r\n                                <IconCard\r\n                                    id={index}\r\n                                    size={row}\r\n                                    src={resizeImageUrl(row)}\r\n                                    version={valueVersion}\r\n                                    webId={webId}\r\n                                />\r\n                            </Col>\r\n                        ))}\r\n                </Row>\r\n            </ResizeIconBody>\r\n        </ResizeIconRoot>\r\n    );\r\n}\r\n\r\nexport default ResizeIcon;\r\n\r\nconst ResizeIconRoot = styled.main``;\r\n\r\nconst ResizeIconHeader = styled.section`\r\n    padding: 30px 0;\r\n    background-color: #ccc;\r\n\r\n    form {\r\n        max-width: 1000px;\r\n        margin: 0 auto;\r\n    }\r\n`;\r\n\r\nconst UploadRoot = styled(Upload)`\r\n    .ant-upload-select-picture-card {\r\n        width: 234px;\r\n        height: 234px;\r\n        padding: 20px;\r\n    }\r\n`;\r\n\r\nconst TitleRoot = styled(Title)`\r\n    margin-bottom: 10px;\r\n`;\r\n\r\nconst InputRoot = styled.div`\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 10px;\r\n    p {\r\n        min-width: 80px;\r\n        margin-right: 10px;\r\n        margin-bottom: 0;\r\n    }\r\n    input {\r\n        width: 170px;\r\n    }\r\n`;\r\n\r\nconst AlertRoot = styled(Alert)`\r\n    position: fixed;\r\n    top: 20px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n`;\r\n\r\nconst ResizeIconBody = styled.section`\r\n    max-width: 1000px;\r\n    margin: 0 auto;\r\n    padding: 30px 0;\r\n`;\r\n"],"sourceRoot":""}